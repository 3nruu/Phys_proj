# Phys_proj

# Численное моделирование дифракции электрона: квантово-механический подход и сравнение с теорией Френеля

## 1. Физическая постановка задачи

**Цель работы:** сравнить квантово-механическое распространение волновой функции электрона через щель(и) с классическим приближением дифракции Френеля–Кирхгофа для скалярных волн (например, света).  
Основное наблюдение: плотность вероятности $|\psi(x,y,t)|^2$ в квантовой механике играет роль, аналогичную интенсивности волны $|U(x,y,z)|^2$ в оптике.

**Почему это возможно?**  
Уравнение Шрёдингера для свободного электрона ($V = 0$):

$$
i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m} \nabla^2 \psi,
$$

после перехода к безразмерным переменным и замены времени $t$ на продольную координату $z$, приводится к виду:

$$
\frac{\partial u}{\partial z} = \frac{i\lambda}{4\pi} \nabla_\perp^2 u,
$$

где $\lambda = h/p = 2\pi/k$ — длина волны де Бройля, а $z$ — направление распространения. Это уравнение *математически эквивалентно* уравнению скалярной дифракции в приближении Френеля.

Таким образом, **время эволюции** в уравнении Шрёдингера соответствует **расстоянию от апертуры** в оптике:

$$
z = v_g (t_f - t_0) = \frac{\hbar k}{m} \Delta t,
$$

где $v_g$ — групповая скорость электрона.

---

## 2. Численная модель и реализация

### 2.1. Уравнение и безразмерные единицы

Рассматривается двумерное нестационарное уравнение Шрёдингера:

$$
i\hbar \frac{\partial \psi(\mathbf{r}, t)}{\partial t} = \left[ -\frac{\hbar^2}{2m} \nabla^2 + V(\mathbf{r}) \right] \psi(\mathbf{r}, t).
$$

Для упрощения вычислений используются **безразмерные единицы**:

$$
\hbar = 1, \quad m = 1.
$$

В этих единицах длина волны де Бройля связана с импульсом как $\lambda = 2\pi / k$.

### 2.2. Начальные условия

В момент $t = t_0$ волновая функция задаётся непосредственно *за плоскостью щели*:

$$
\psi(x, y, t_0) = \psi_0(x, y) \cdot \Pi(x, y),
$$

где:
- $\psi_0(x, y) = e^{i(k_x x + k_y y)}$ — плоская волна, направленная вдоль оси $x$,
- $\Pi(x, y)$ — характеристическая функция апертуры (1 внутри щелей, 0 вне).

Такой подход исключает моделирование взаимодействия с потенциальным барьером и соответствует постановке задачи дифракции в волновой оптике.

### 2.3. Численный метод: схема Кранка–Николсона

Для интегрирования уравнения по времени применяется **метод Кранка–Николсона** — неявная конечно-разностная схема второго порядка точности, обладающая свойством унитарности (сохранения нормы $\int |\psi|^2 d\mathbf{r} = 1$).

Дискретизация по времени с шагом $\Delta t$ приводит к системе:

$$
\left( \mathbf{I} + \frac{i \Delta t}{2} \hat{H} \right) \psi^{n+1}=\left( \mathbf{I} - \frac{i \Delta t}{2} \hat{H} \right) \psi^{n},
$$

или в операторной форме:

$$
\mathbf{A} \psi^{n+1} = \mathbf{B} \psi^{n}.
$$

Для численного решения уравнения Шрёдингера методом Кранка–Николсон используются две матрицы:

$$
\text{Mat1} = A = I + \frac{i \Delta t}{2} H
$$

$$
\text{Mat2} = B = I - \frac{i \Delta t}{2} H
$$

где:
- $I$ — единичная матрица,
- $i$ — мнимая единица,
- $\Delta t$ — шаг по времени,
- $H$ — дискретный гамильтониан оператор (включающий кинетическую энергию и потенциал).

**Схема эволюции:**  
На каждом временном шаге решается линейная система  
$$
A \psi(t + \Delta t) = B \psi(t)
$$
для нахождения волновой функции на следующем шаге.

---

## 2.4 Пространственная дискретизация

**Сетка:** равномерная прямоугольная,
$$
x_i = x_{\min} + i \cdot dx, \quad y_j = y_{\min} + j \cdot dy,
$$
с $dx = dy$.

**Хранение:** волновая функция хранится как вектор длины $N_x N_y$, где элемент $(i,j)$ имеет индекс $i + j N_y$.

**Дискретизация лапласиана:** аппроксимируется пятиточечным шаблоном:
$$
\nabla^2 \psi_{i,j} \approx \frac{\psi_{i+1,j} + \psi_{i-1,j} + \psi_{i,j+1} + \psi_{i,j-1} - 4\psi_{i,j}}{dx^2}.
$$

**Граничные условия:** $\psi = 0$ на всех границах области — имитация бесконечной потенциальной ямы.

**Потенциал $V(x,y)$** (если используется) задаётся как вектор той же длины и добавляется к диагонали гамильтониана.

---

## 2.5 Структура класса `WaveFunction`

Класс реализует следующие методы:

- `__init__` — инициализация сетки, начального состояния, потенциала и построение разреженных матриц $A$, $B$;
- `get_prob()` — возвращает плотность вероятности $|\psi|^2$;
- `compute_norm()` — вычисляет норму $\int |\psi|^2 \, dx\, dy$;
- `step()` — выполняет один временной шаг эволюции.

---

## 3. План сравнения с теорией Френеля

1. **Выполнить квантовую эволюцию** до времени $t_f$, соответствующего расстоянию
   $$
   z = \frac{\hbar k}{m} (t_f - t_0).
   $$

2. **Зафиксировать** $|\psi(x_f, y, t_f)|^2$ — квантовая «интенсивность».

3. **Вычислить классическое поле** по формуле Френеля:
   $$
   U(x,y,z) = \frac{e^{i k z}}{i \lambda z} \iint U_0(x',y') \exp\left( \frac{i\pi}{\lambda z} \left[(x-x')^2 + (y-y')^2\right] \right) dx'\, dy',
   $$
   где $U_0(x,y) = \psi(x,y,t_0)$.

4. **Сравнить одномерные срезы:**
   $$
   I_{\text{QM}}(y) = \int |\psi(x_f, y, t_f)|^2 \, dx, \quad I_{\text{Fresnel}}(y) = |U(x_f, y, z)|^2.
   $$

5. **Исследовать зависимость точности совпадения от:**
   - энергии электрона,
   - ширины щели,
   - расстояния до экрана.


5. **Исследовать зависимость точности совпадения от:**
   - энергии электрона,
   - ширины щели,
   - расстояния до экрана.
