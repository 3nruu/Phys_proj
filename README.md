Численное моделирование дифракции электрона: квантово-механический подход и сравнение с теорией Френеля

# 1. Физическая постановка задачи

Цель работы: сравнить квантово-механическое распространение волновой функции электрона через щель(и) с классическим приближением дифракции Френеля–Кирхгофа для скалярных волн (например, света). Основное наблюдение: плотность вероятности $|\psi(x,y,t)|^2$ в квантовой механике играет роль, аналогичную интенсивности волны $|U(x,y,z)|^2$ в оптике.

Почему это возможно? Уравнение Шрёдингера для свободного электрона ($V = 0$):

$$
i \hbar \frac {\partial \psi}{\partial t} = - \frac {\hbar^ {2}}{2 m} \nabla^ {2} \psi ,
$$

после перехода к безразмерным переменным и замены времени $t$ на продольную координату $z$, приводится к виду:

$$
\frac {\partial u}{\partial z} = \frac {i \lambda}{4 \pi} \nabla_ {\perp} ^ {2} u,
$$

где $\lambda = h/p = 2\pi/k$ — длина волны де Бройля, а $z$ — направление распространения. Это уравнение математически эквивалентно уравнению скалярной дифракции в приближении Френеля. Таким образом, время эволюции в уравнении Шрёдингера соответствует расстоянию от апертуры в оптике:

$$
z = v _ {g} (t _ {f} - t _ {0}) = \frac {\hbar k}{m} \Delta t,
$$

где $v_{g}$ — групповая скорость электрона.

---
2

# 2. Численная модель и реализация

## 2.1. Уравнение и безразмерные единицы

Рассматривается двумерное нестационарное уравнение Шрёдингера:

$$
i \hbar \frac {\partial \psi (\mathbf {r} , t)}{\partial t} = \left[ - \frac {\hbar^ {2}}{2 m} \nabla^ {2} + V (\mathbf {r}) \right] \psi (\mathbf {r}, t).
$$

Для упрощения вычислений используются безразмерные единицы:

$$
\hbar = 1, \quad m = 1.
$$

В этих единицах длина волны де Бройля связана с импульсом как $\lambda = 2\pi /k$.

## 2.2. Начальные условия

В момент $t = t_0$ волновая функция задаётся непосредственно за плоскостью щели:

$$
\psi (x, y, t _ {0}) = \psi_ {0} (x, y) \cdot \Pi (x, y),
$$

где:

- $\psi_0(x,y) = e^{i(k_xx + k_yy)}$ — плоская волна, направленная вдоль оси $x$,
- $\Pi (x,y)$ — характеристическая функция апертуры (1 внутри щелей, 0 вне).

Такой подход исключает моделирование взаимодействия с потенциальным барьером и соответствует постановке задачи дифракции в волновой оптике.

## 2.3. Численный метод: схема Кранка–Николсона

Для интегрирования уравнения по времени применяется метод Кранка–Николсона — неявная конечно-разностная схема второго порядка точности, обладающая свойством унитарности (сохранения нормы $\int |\psi |^2 d\mathbf{r} = 1$).

Дискретизация по времени с шагом $\Delta t$ приводит к системе:

$$
\left(\mathbf {I} + \frac {i \Delta t}{2} \hat {H}\right) \psi^ {n + 1} = \left(\mathbf {I} - \frac {i \Delta t}{2} \hat {H}\right) \psi^ {n},
$$

или в операторной форме:

$$
\mathbf {A} \psi^ {n + 1} = \mathbf {B} \psi^ {n}.
$$

В коде это реализовано как:

self.psi = spsolve(self.Mat1, self.Mat2.dot(self.psi))

где:

- $\mathbf{Mat1} = \mathbf{A} = \mathbf{I} + \frac{i\Delta t}{2}\mathbf{H},$

---
- $\mathbf{Mat2} = \mathbf{B} = \mathbf{I} - \frac{i\Delta t}{2}\mathbf{H}$.

## 2.4. Пространственная дискретизация

- Сетка: равномерная прямоугольная, $x_i = x_{\min} + i\,dx$, $y_j = y_{\min} + j\,dy$, с $dx = dy$.
- Волновая функция хранится как вектор длины $N_xN_y$, где элемент $(i,j)$ имеет индекс $i + jN_y$.
- Лапласиан аппроксимируется пятиточечным шаблоном:

$$
\nabla^2 \psi_{i,j} \approx \frac{\psi_{i+1,j} + \psi_{i-1,j} + \psi_{i,j+1} + \psi_{i,j-1} - 4\psi_{i,j}}{dx^2}.
$$

- Границные условия: $\psi = 0$ на всех границах области — имитация бесконечной потенциальной ямы.
- Потенциал $V(x,y)$ (если используется) задаётся как вектор той же длины и добавляется к диагонали гамильтониана.

## 2.5. Структура класса WaveFunction

Класс реализует следующие методы:

- __init__ — инициализация сетки, начального состояния, потенциала и построение разреженных матриц A, B;
- get_prob() — возвращает плотность вероятности $|\psi|^2$;
- compute_norm() — вычисляет норму $\int |\psi|^2 dx\,dy$;
- step() — выполняет один временной шаг эволюции.

## 3. План сравнения с теорией Френеля

1. Выполнить квантовую эволюцию до времени $t_f$, соответствующего расстоянию $z = (\hbar k/m)(t_f - t_0)$.
2. Зафиксировать $|\psi(x_f, y, t_f)|^2$ — квантовая «интенсивность».
3. Вычислить классическое поле по формуле Френеля:

$$
U(x, y, z) = \frac{e^{ikz}}{i\lambda z} \iint U_0(x', y') \exp\left(\frac{i\pi}{\lambda z}\left[(x - x')^2 + (y - y')^2\right]\right) dx'\,dy',
$$

где $U_0(x,y) = \psi(x,y,t_0)$.

4. Сравнить одномерные срезы:

$$
I_{\mathrm{QM}}(y) = \int |\psi(x_f, y, t_f)|^2 dx, \quad I_{\mathrm{Fresnel}}(y) = |U(x_f, y, z)|^2.
$$

5. Исследовать зависимость точности совпадения от энергии электрона, ширины щели и расстояния до экрана.


# Численное моделирование дифракции электрона  
## Квантово-механический подход и сравнение с теорией Френеля

---

## 1. Численное вычисление волновой функции и поля Френеля

### 1.1. Квантово-механическая модель

Рассматривается распространение свободного электрона в двумерном пространстве  
\((x, y)\) после прохождения через систему щелей. Динамика волновой функции  
\(\psi(x, y, t)\) описывается нестационарным уравнением Шрёдингера:

\[
i \hbar \frac{\partial \psi}{\partial t}
=
-\frac{\hbar^2}{2m}
\left(
\frac{\partial^2 \psi}{\partial x^2}
+
\frac{\partial^2 \psi}{\partial y^2}
\right),
\]

где \(m\) — масса частицы, \(\hbar\) — приведённая постоянная Планка.  
В численных расчётах используются безразмерные единицы \(\hbar = m = 1\).

---

### Начальные условия

В момент времени \(t = 0\) волновая функция задаётся непосредственно за плоскостью щелей:

\[
\psi(x, y, 0) =
\begin{cases}
e^{i k_x x}, & (x, y) \in \text{область щелей}, \\
0, & \text{вне щелей}.
\end{cases}
\]

Таким образом моделируется прохождение плоской волны с продольным импульсом  
\(k_x\) через апертуру без явного моделирования потенциального барьера.

---

### Численный метод

Для интегрирования уравнения Шрёдингера используется **схема Кранка–Николсона**, которая:

- является неявной;
- имеет второй порядок точности по времени;
- сохраняет норму волновой функции (унитарность).

После дискретизации по пространству уравнение приводится к матричной форме:

\[
\left(I + \frac{i\Delta t}{2} \hat{H}\right)\psi^{n+1}
=
\left(I - \frac{i\Delta t}{2} \hat{H}\right)\psi^{n},
\]

где \(\hat{H}\) — дискретизированный гамильтониан с лапласианом, аппроксимированным
пятиточечным шаблоном.

Граничные условия выбираются жёсткими (Dirichlet):

\[
\psi = 0 \quad \text{на границах области}.
\]

Для ускорения вычислений матрица левой части факторизуется один раз
(LU-разложение), после чего каждый временной шаг сводится к решению двух
треугольных систем.

Результатом моделирования является плотность вероятности:

\[
I_{\text{QM}}(x, y, t) = |\psi(x, y, t)|^2.
\]

---

## 1.2. Модель дифракции Френеля

Для сравнения используется классическая теория дифракции Френеля–Кирхгофа
в параксиальном приближении.

В одномерной постановке поле \(U(y, z)\) на расстоянии \(z\) от апертуры
определяется интегралом Френеля:

\[
U(y, z)
=
\frac{e^{i k z}}{i \lambda z}
\int U_0(y')
\exp\left(
i \frac{\pi}{\lambda z} (y - y')^2
\right)
\, dy',
\]

где:
- \(U_0(y)\) — поле в плоскости щелей;
- \(\lambda = 2\pi / k_x\) — длина волны де Бройля.

Начальное поле выбирается в виде той же апертуры, что и в квантовой задаче:

\[
U_0(y) =
\begin{cases}
1, & y \in \text{область щелей}, \\
0, & \text{вне}.
\end{cases}
\]

Интенсивность определяется как:

\[
I_{\text{F}}(y, z) = |U(y, z)|^2.
\]

Для корректного сравнения с квантово-механической моделью каждое распределение
интенсивности нормируется по координате \(y\), так как сравнивается форма
распределения, а не абсолютная амплитуда.

---

## 2. Оценка применимости приближения Френеля

Приближение Френеля основано на следующих физических предположениях:

1. **Параксиальность распространения**  
   \[
   k_y \ll k_x,
   \]
   то есть поперечные компоненты импульса малы по сравнению с продольной.

2. **Достаточное расстояние от апертуры**  
   Характерное расстояние Френеля оценивается как
   \[
   z_F \sim \frac{d^2}{\lambda},
   \]
   где \(d\) — характерный размер апертуры.

В непосредственной близости от щелей данные условия нарушаются:
волновая функция содержит значительные поперечные компоненты импульса,
а фазовая структура резко изменяется.
Поэтому в ближнем поле модель Френеля не обязана совпадать
с полной квантово-механической динамикой.

Ожидается, что согласие между моделями улучшается по мере увеличения расстояния
от апертуры.

---

## 3. Построение графика ошибки между моделями

### 3.1. Приведение данных к сопоставимому виду

Для каждого значения координаты \(x\) (после плоскости щелей) вычисляются:

- квантовая интенсивность
  \[
  I_{\text{QM}}(y, x),
  \]
- интенсивность Френеля
  \[
  I_{\text{F}}(y, z = x - x_{\text{slit}}).
  \]

Обе величины нормируются так, чтобы выполнялось условие:

\[
\int I(y)\,dy = 1.
\]

---

### 3.2. Мера ошибки

В качестве количественной меры различия используется \(L^2\)-норма по координате \(y\):

\[
\varepsilon(x)
=
\left(
\int
\left[
I_{\text{QM}}(y, x) - I_{\text{F}}(y, x)
\right]^2
dy
\right)^{1/2}.
\]

Эта величина характеризует различие форм распределений интенсивности
на фиксированном расстоянии от щелей.

---

### 3.3. Интерпретация графика

График ошибки \(\varepsilon(x)\) обладает следующими характерными особенностями:

- рост ошибки в непосредственной близости от апертуры;
- максимум в области переходного (ближнего) поля;
- постепенное уменьшение ошибки с ростом расстояния;
- выход на плато, обусловленный численными и модельными ограничениями.

Наблюдаемые осцилляции связаны с интерференционной структурой распределений
и высокой чувствительностью нормы \(L^2\) к фазовым сдвигам.

---

## 4. План исследования зависимости от начальных параметров

Для систематического анализа применимости приближения Френеля предлагается
следующий план вычислительных экспериментов.

### 4.1. Зависимость от энергии частицы

Изменение продольного импульса \(k_x\):

- увеличение \(k_x\) соответствует уменьшению длины волны \(\lambda\);
- параксиальное приближение должно выполняться при меньших расстояниях;
- ожидается уменьшение ошибки и более быстрый спад \(\varepsilon(x)\).

---

### 4.2. Зависимость от геометрии щелей

Планируется варьировать:

- ширину щелей;
- расстояние между щелями.

Это позволяет проверить масштабирование характерного расстояния Френеля:

\[
z_F \propto \frac{d^2}{\lambda}.
\]

---

### 4.3. Зависимость от расстояния до экрана

Анализ ошибки как функции координаты \(x\) позволяет определить:

- минимальное расстояние, начиная с которого приближение Френеля применимо;
- границу между ближним и дальним полем.

---

### 4.4. Сравнение режимов

Дополнительно возможны следующие исследования:

- сравнение с аналитическим пределом Фраунгофера;
- анализ перехода от полной квантовой динамики к параксиальному приближению.

---

## Заключение

Проведённое численное моделирование показывает, что теория дифракции Френеля
является корректным приближением квантово-механической динамики волновой функции
электрона на достаточно больших расстояниях от апертуры.
Построенный график ошибки позволяет количественно определить область применимости
параксиального приближения и проследить переход от точного квантового описания
к эффективной волновой модели.

---

