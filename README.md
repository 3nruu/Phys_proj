# Phys_proj

# Численное моделирование дифракции электрона: квантово-механический подход и сравнение с теорией Френеля

## 1. Физическая постановка задачи

**Цель работы:** сравнить квантово-механическое распространение волновой функции электрона через щель(и) с классическим приближением дифракции Френеля–Кирхгофа для скалярных волн (например, света).  
Основное наблюдение: плотность вероятности $|\psi(x,y,t)|^2$ в квантовой механике играет роль, аналогичную интенсивности волны $|U(x,y,z)|^2$ в оптике.

**Почему это возможно?**  
Уравнение Шрёдингера для свободного электрона ($V = 0$):

$$
i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m} \nabla^2 \psi,
$$

после перехода к безразмерным переменным и замены времени $t$ на продольную координату $z$, приводится к виду:

$$
\frac{\partial u}{\partial z} = \frac{i\lambda}{4\pi} \nabla_\perp^2 u,
$$

где $\lambda = h/p = 2\pi/k$ — длина волны де Бройля, а $z$ — направление распространения. Это уравнение *математически эквивалентно* уравнению скалярной дифракции в приближении Френеля.

Таким образом, **время эволюции** в уравнении Шрёдингера соответствует **расстоянию от апертуры** в оптике:

$$
z = v_g (t_f - t_0) = \frac{\hbar k}{m} \Delta t,
$$

где $v_g$ — групповая скорость электрона.

---

## 2. Численная модель и реализация

### 2.1. Уравнение и безразмерные единицы

Рассматривается двумерное нестационарное уравнение Шрёдингера:

$$
i\hbar \frac{\partial \psi(\mathbf{r}, t)}{\partial t} = \left[ -\frac{\hbar^2}{2m} \nabla^2 + V(\mathbf{r}) \right] \psi(\mathbf{r}, t).
$$

Для упрощения вычислений используются **безразмерные единицы**:

$$
\hbar = 1, \quad m = 1.
$$

В этих единицах длина волны де Бройля связана с импульсом как $\lambda = 2\pi / k$.

### 2.2. Начальные условия

В момент $t = t_0$ волновая функция задаётся непосредственно *за плоскостью щели*:

$$
\psi(x, y, t_0) = \psi_0(x, y) \cdot \Pi(x, y),
$$

где:
- $\psi_0(x, y) = e^{i(k_x x + k_y y)}$ — плоская волна, направленная вдоль оси $x$,
- $\Pi(x, y)$ — характеристическая функция апертуры (1 внутри щелей, 0 вне).

Такой подход исключает моделирование взаимодействия с потенциальным барьером и соответствует постановке задачи дифракции в волновой оптике.

### 2.3. Численный метод: схема Кранка–Николсона

Для интегрирования уравнения по времени применяется **метод Кранка–Николсона** — неявная конечно-разностная схема второго порядка точности, обладающая свойством унитарности (сохранения нормы $\int |\psi|^2 d\mathbf{r} = 1$).

Дискретизация по времени с шагом $\Delta t$ приводит к системе:

$$
\left( \mathbf{I} + \frac{i \Delta t}{2} \hat{H} \right) \psi^{n+1}
=
\left( \mathbf{I} - \frac{i \Delta t}{2} \hat{H} \right) \psi^{n},
$$

или в операторной форме:

$$
\mathbf{A} \psi^{n+1} = \mathbf{B} \psi^{n}.
$$

В коде это реализовано как:

```python
self.psi = spsolve(self.Mat1, self.Mat2.dot(self.psi))
